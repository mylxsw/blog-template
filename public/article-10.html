<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dockerå®¹å™¨åŒ–æŠ€æœ¯è¯¦è§£ï¼šä»å…¥é—¨åˆ°å®è·µ</title>
    <link rel="stylesheet" href="/styles/modern.css">
    <link rel="alternate" type="application/rss+xml" title="äººäººé“¾å‘æœªæ¥ RSS Feed" href="/rss.xml">
    <!-- Highlight.js theme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
                        colors: {
                            primary: { 600: '#FECE00', 700: '#e6b900' },
                            accent: { 400: '#FECE00', 500: '#ffdb4d' }
                        }
          }
        }
      }
    </script>
</head>
<body class="bg-gray-50">
    <header class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="/" class="navbar-logo">äººäººé“¾å‘æœªæ¥</a>
            </div>
            <nav class="navbar-menu" id="navbar-menu">
                <div class="navbar-nav">
                    <a href="/" class="nav-item">
                        <span class="nav-text">é¦–é¡µ</span>
                    </a>
                    <a href="/about.html" class="nav-item">
                        <span class="nav-text">å…³äº</span>
                    </a>
                    <a href="/rss.xml" class="nav-item nav-item-special" target="_blank" rel="noopener noreferrer">
                        <span class="nav-text">RSS</span>
                    </a>
                </div>
            </nav>
            <button class="navbar-toggle" id="navbar-toggle" aria-label="åˆ‡æ¢å¯¼èˆªèœå•">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <article class="article-container">
            <div class="article-header">
                <h1 class="article-title">Dockerå®¹å™¨åŒ–æŠ€æœ¯è¯¦è§£ï¼šä»å…¥é—¨åˆ°å®è·µ</h1>
                <div class="article-meta">
                    <div class="flex items-center space-x-2">
                        <time datetime="2023-10-25T00:00:00.000Z">2023å¹´10æœˆ25æ—¥</time>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <span class="post-tag">docker</span>
                        <span class="post-tag">devops</span>
                        <span class="post-tag">containerization</span>
                    </div>
                </div>
                <div class="w-full h-80 overflow-hidden mt-6">
                    <img src="https://images.unsplash.com/photo-1542837332-64e3c71fbe2c?ixlib&#x3D;rb-4.0.3&amp;ixid&#x3D;M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto&#x3D;format&amp;fit&#x3D;crop&amp;w&#x3D;1200&amp;q&#x3D;80" alt="Dockerå®¹å™¨åŒ–æŠ€æœ¯è¯¦è§£ï¼šä»å…¥é—¨åˆ°å®è·µ" class="w-full h-full object-cover rounded-xl" loading="lazy" onerror="this.onerror=null;this.src='/assets/placeholder.svg';this.classList.add('placeholder');">
                </div>
            </div>
            <div class="article-content">
                <p>å®¹å™¨åŒ–æŠ€æœ¯æ­£åœ¨æ”¹å˜è½¯ä»¶å¼€å‘å’Œéƒ¨ç½²çš„æ–¹å¼ï¼Œè€ŒDockerä½œä¸ºå®¹å™¨åŒ–æŠ€æœ¯çš„é¢†å†›è€…ï¼Œå·²ç»æˆä¸ºç°ä»£DevOpså®è·µçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»Dockerçš„æ ¸å¿ƒæ¦‚å¿µã€ä½¿ç”¨æ–¹æ³•å’Œæœ€ä½³å®è·µã€‚</p>
<h2>ä»€ä¹ˆæ˜¯Dockerï¼Ÿ</h2>
<p>Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨åŒ–å¹³å°ï¼Œå®ƒå…è®¸å¼€å‘è€…å°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹æ‰“åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œä»è€Œå®ç°åº”ç”¨ç¨‹åºåœ¨ä»»ä½•ç¯å¢ƒä¸­çš„ä¸€è‡´è¿è¡Œã€‚</p>
<h3>å®¹å™¨åŒ–çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šå¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒä¿æŒä¸€è‡´</li>
<li><strong>è½»é‡çº§</strong>ï¼šç›¸æ¯”è™šæ‹Ÿæœºï¼Œå®¹å™¨æ›´åŠ è½»é‡</li>
<li><strong>å¿«é€Ÿå¯åŠ¨</strong>ï¼šå®¹å™¨å¯ä»¥åœ¨ç§’çº§å¯åŠ¨</li>
<li><strong>èµ„æºåˆ©ç”¨ç‡é«˜</strong>ï¼šå¤šä¸ªå®¹å™¨å¯ä»¥å…±äº«å®¿ä¸»æœºèµ„æº</li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ”¯æŒå¿«é€Ÿæ°´å¹³æ‰©å±•</li>
</ol>
<h2>Dockeræ ¸å¿ƒæ¦‚å¿µ</h2>
<h3>1. é•œåƒï¼ˆImageï¼‰</h3>
<p>Dockeré•œåƒæ˜¯ä¸€ä¸ªåªè¯»æ¨¡æ¿ï¼ŒåŒ…å«äº†è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚</p>
<h3>2. å®¹å™¨ï¼ˆContainerï¼‰</h3>
<p>å®¹å™¨æ˜¯é•œåƒçš„è¿è¡Œå®ä¾‹ã€‚å¯ä»¥å¯åŠ¨ã€åœæ­¢ã€ç§»åŠ¨å’Œåˆ é™¤å®¹å™¨ã€‚</p>
<h3>3. Dockerfile</h3>
<p>Dockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œç”¨äºè‡ªåŠ¨åŒ–æ„å»ºé•œåƒã€‚</p>
<h3>4. ä»“åº“ï¼ˆRegistryï¼‰</h3>
<p>ä»“åº“æ˜¯å­˜å‚¨å’Œåˆ†å‘Dockeré•œåƒçš„åœ°æ–¹ã€‚Docker Hubæ˜¯æœ€å¸¸ç”¨çš„å…¬å…±ä»“åº“ã€‚</p>
<h2>Dockerå®‰è£…ä¸é…ç½®</h2>
<h3>Windowså’ŒMac</h3>
<p>ä¸‹è½½Docker Desktopå®‰è£…åŒ…ï¼ŒæŒ‰ç…§æç¤ºå®Œæˆå®‰è£…ã€‚</p>
<h3>Linuxï¼ˆä»¥Ubuntuä¸ºä¾‹ï¼‰</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># æ›´æ–°åŒ…ç´¢å¼•</span>
<span class="hljs-built_in">sudo</span> apt-get update

<span class="hljs-comment"># å®‰è£…å¿…è¦çš„åŒ…</span>
<span class="hljs-built_in">sudo</span> apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

<span class="hljs-comment"># æ·»åŠ Dockerå®˜æ–¹GPGå¯†é’¥</span>
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | <span class="hljs-built_in">sudo</span> gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

<span class="hljs-comment"># è®¾ç½®ç¨³å®šç‰ˆä»“åº“</span>
<span class="hljs-built_in">echo</span> \
  <span class="hljs-string">&quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
  <span class="hljs-subst">$(lsb_release -cs)</span> stable&quot;</span> | <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null

<span class="hljs-comment"># å®‰è£…Docker Engine</span>
<span class="hljs-built_in">sudo</span> apt-get update
<span class="hljs-built_in">sudo</span> apt-get install docker-ce docker-ce-cli containerd.io

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
<span class="hljs-built_in">sudo</span> docker run hello-world
</code></pre></div><h2>DockeråŸºæœ¬æ“ä½œ</h2>
<h3>é•œåƒæ“ä½œ</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># æœç´¢é•œåƒ</span>
docker search nginx

<span class="hljs-comment"># æ‹‰å–é•œåƒ</span>
docker pull nginx

<span class="hljs-comment"># æŸ¥çœ‹æœ¬åœ°é•œåƒ</span>
docker images

<span class="hljs-comment"># åˆ é™¤é•œåƒ</span>
docker rmi image_name
</code></pre></div><h3>å®¹å™¨æ“ä½œ</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># è¿è¡Œå®¹å™¨</span>
docker run -d -p 8080:80 --name mynginx nginx

<span class="hljs-comment"># æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</span>
docker ps

<span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬åœæ­¢çš„ï¼‰</span>
docker ps -a

<span class="hljs-comment"># åœæ­¢å®¹å™¨</span>
docker stop container_name

<span class="hljs-comment"># å¯åŠ¨å®¹å™¨</span>
docker start container_name

<span class="hljs-comment"># é‡å¯å®¹å™¨</span>
docker restart container_name

<span class="hljs-comment"># åˆ é™¤å®¹å™¨</span>
docker <span class="hljs-built_in">rm</span> container_name

<span class="hljs-comment"># è¿›å…¥å®¹å™¨</span>
docker <span class="hljs-built_in">exec</span> -it container_name /bin/bash
</code></pre></div><h3>å®¹å™¨æ—¥å¿—å’Œä¿¡æ¯</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span>
docker logs container_name

<span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</span>
docker inspect container_name

<span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ</span>
docker stats container_name
</code></pre></div><h2>Dockerfileè¯¦è§£</h2>
<p>Dockerfileæ˜¯æ„å»ºDockeré•œåƒçš„è„šæœ¬æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸€ç³»åˆ—æŒ‡ä»¤ã€‚</p>
<h3>åŸºæœ¬æŒ‡ä»¤</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-dockerfile"><span class="hljs-comment"># æŒ‡å®šåŸºç¡€é•œåƒ</span>
<span class="hljs-keyword">FROM</span> ubuntu:<span class="hljs-number">20.04</span>

<span class="hljs-comment"># ç»´æŠ¤è€…ä¿¡æ¯</span>
<span class="hljs-keyword">LABEL</span><span class="language-bash"> maintainer=<span class="hljs-string">&quot;yourname@example.com&quot;</span></span>

<span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span>
<span class="hljs-keyword">ENV</span> NODE_VERSION=<span class="hljs-number">14.15</span>.<span class="hljs-number">0</span>

<span class="hljs-comment"># è®¾ç½®å·¥ä½œç›®å½•</span>
<span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span>

<span class="hljs-comment"># å¤åˆ¶æ–‡ä»¶</span>
<span class="hljs-keyword">COPY</span><span class="language-bash"> . /app</span>

<span class="hljs-comment"># è¿è¡Œå‘½ä»¤</span>
<span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y nodejs npm</span>

<span class="hljs-comment"># æš´éœ²ç«¯å£</span>
<span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">3000</span>

<span class="hljs-comment"># å¯åŠ¨å‘½ä»¤</span>
<span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;node&quot;</span>, <span class="hljs-string">&quot;app.js&quot;</span>]</span>
</code></pre></div><h3>æ„å»ºé•œåƒ</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># æ„å»ºé•œåƒ</span>
docker build -t myapp:latest .

<span class="hljs-comment"># æŒ‡å®šDockerfileè·¯å¾„</span>
docker build -f /path/to/Dockerfile -t myapp:latest .
</code></pre></div><h2>å®é™…æ¡ˆä¾‹ï¼šæ„å»ºNode.jsåº”ç”¨é•œåƒ</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…çš„Node.jsåº”ç”¨æ¥æ¼”ç¤ºDockerçš„ä½¿ç”¨ã€‚</p>
<h3>åº”ç”¨ä»£ç </h3>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨ï¼š</p>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs">// app.js
const express = require('express');
const app = express();
const PORT = process.env.PORT || 3000;

app.get('/', (req, res) =&gt; {
  res.send('Hello Docker World!');
});

app.get('/health', (req, res) =&gt; {
  res.json({ status: 'OK', timestamp: new Date().toISOString() });
});

app.listen(PORT, () =&gt; {
  console.log(`Server is running on port ${PORT}`);
});
</code></pre></div><div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-json"><span class="hljs-comment">// package.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;docker-nodejs-app&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;A simple Node.js app for Docker tutorial&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;app.js&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node app.js&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;express&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.17.1&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre></div><h3>Dockerfile</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># ä½¿ç”¨å®˜æ–¹Node.jsè¿è¡Œæ—¶ä½œä¸ºåŸºç¡€é•œåƒ
FROM node:14-alpine

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /usr/src/app

# å¤åˆ¶package.jsonå’Œpackage-lock.json
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm ci --only=production

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 3000

# åˆ›å»ºérootç”¨æˆ·
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nextjs -u 1001

# æ›´æ”¹æ–‡ä»¶æ‰€æœ‰æƒ
USER nextjs

# å¯åŠ¨åº”ç”¨
CMD [ &quot;npm&quot;, &quot;start&quot; ]
</code></pre></div><h3>æ„å»ºå’Œè¿è¡Œ</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># æ„å»ºé•œåƒ
docker build -t docker-nodejs-app .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 docker-nodejs-app

# åœ¨åå°è¿è¡Œ
docker run -d -p 3000:3000 --name my-node-app docker-nodejs-app
</code></pre></div><h2>Docker Compose</h2>
<p>Docker Composeæ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚</p>
<h3>docker-compose.ymlç¤ºä¾‹</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs">version: '3.8'

services:
  web:
    build: .
    ports:
      - &quot;3000:3000&quot;
    depends_on:
      - redis
    environment:
      - REDIS_URL=redis://redis:6379

  redis:
    image: &quot;redis:alpine&quot;
    ports:
      - &quot;6379:6379&quot;
</code></pre></div><h3>Docker Composeå‘½ä»¤</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up

# åå°å¯åŠ¨
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs

# é‡æ–°æ„å»ºæœåŠ¡
docker-compose build
</code></pre></div><h2>Dockerç½‘ç»œ</h2>
<p>Dockeræä¾›äº†å¤šç§ç½‘ç»œæ¨¡å¼æ¥æ»¡è¶³ä¸åŒçš„éœ€æ±‚ã€‚</p>
<h3>ç½‘ç»œç±»å‹</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># æŸ¥çœ‹ç½‘ç»œ
docker network ls

# åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ
docker network create mynetwork

# è¿è¡Œå®¹å™¨å¹¶è¿æ¥åˆ°ç½‘ç»œ
docker run -d --name container1 --network mynetwork nginx

# è¿æ¥ç°æœ‰å®¹å™¨åˆ°ç½‘ç»œ
docker network connect mynetwork container2
</code></pre></div><h2>Dockeræ•°æ®æŒä¹…åŒ–</h2>
<h3>å·ï¼ˆVolumesï¼‰</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># åˆ›å»ºå·
docker volume create myvolume

# ä½¿ç”¨å·è¿è¡Œå®¹å™¨
docker run -d --name mycontainer -v myvolume:/app/data nginx

# æŸ¥çœ‹å·
docker volume ls

# åˆ é™¤å·
docker volume rm myvolume
</code></pre></div><h3>ç»‘å®šæŒ‚è½½</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># ç»‘å®šæŒ‚è½½
docker run -d --name mycontainer -v /host/path:/container/path nginx
</code></pre></div><h2>Dockeræœ€ä½³å®è·µ</h2>
<h3>1. é•œåƒä¼˜åŒ–</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># ä½¿ç”¨æ›´å°çš„åŸºç¡€é•œåƒ
FROM alpine:latest

# åˆå¹¶RUNæŒ‡ä»¤å‡å°‘å±‚æ•°
RUN apk add --no-cache \
    nodejs \
    npm

# ä½¿ç”¨.dockerignoreæ–‡ä»¶
# .dockerignoreå†…å®¹ï¼š
# node_modules
# npm-debug.log
# .git
# .gitignore
</code></pre></div><h3>2. å®‰å…¨æ€§</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># åˆ›å»ºérootç”¨æˆ·
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nextjs -u 1001

# ä½¿ç”¨ç‰¹å®šç”¨æˆ·è¿è¡Œ
USER nextjs
</code></pre></div><h3>3. å¤šé˜¶æ®µæ„å»º</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># å¤šé˜¶æ®µæ„å»ºç¤ºä¾‹
# æ„å»ºé˜¶æ®µ
FROM node:14 AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# è¿è¡Œé˜¶æ®µ
FROM node:14-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY --from=builder /app/dist ./dist
CMD [&quot;node&quot;, &quot;dist/index.js&quot;]
</code></pre></div><h3>4. æ ‡ç­¾ç®¡ç†</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ ‡ç­¾
docker build -t myapp:v1.0.0 .
docker build -t myapp:latest .

# ä½¿ç”¨git commit hashä½œä¸ºæ ‡ç­¾
docker build -t myapp:$(git rev-parse --short HEAD) .
</code></pre></div><h2>Dockeråœ¨CI/CDä¸­çš„åº”ç”¨</h2>
<h3>GitHub Actionsç¤ºä¾‹</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs">name: Docker Build and Push

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    
    - name: Login to DockerHub
      uses: docker/login-action@v1
      with:
        username: ${{ secrets.DOCKERHUB_USERNAME }}
        password: ${{ secrets.DOCKERHUB_TOKEN }}
    
    - name: Build and push
      uses: docker/build-push-action@v2
      with:
        context: .
        push: true
        tags: myusername/myapp:latest
</code></pre></div><h2>ç›‘æ§å’Œæ—¥å¿—</h2>
<h3>ä½¿ç”¨Prometheuså’ŒGrafanaç›‘æ§</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># docker-compose.yml
version: '3.8'

services:
  app:
    build: .
    ports:
      - &quot;3000:3000&quot;
  
  prometheus:
    image: prom/prometheus
    ports:
      - &quot;9090:9090&quot;
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
  
  grafana:
    image: grafana/grafana
    ports:
      - &quot;3001:3000&quot;
    depends_on:
      - prometheus
</code></pre></div><h2>æ•…éšœæ’é™¤</h2>
<h3>å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3>
<ol>
<li>
<p><strong>ç«¯å£å†²çª</strong></p>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># æŸ¥çœ‹ç«¯å£å ç”¨</span>
docker ps -a
<span class="hljs-comment"># åœæ­¢å ç”¨ç«¯å£çš„å®¹å™¨</span>
docker stop container_name
</code></pre></div></li>
<li>
<p><strong>æƒé™é—®é¢˜</strong></p>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># åœ¨Linuxä¸Šï¼Œå°†ç”¨æˆ·æ·»åŠ åˆ°dockerç»„</span>
<span class="hljs-built_in">sudo</span> usermod -aG docker <span class="hljs-variable">$USER</span>
</code></pre></div></li>
<li>
<p><strong>ç£ç›˜ç©ºé—´ä¸è¶³</strong></p>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># æ¸…ç†æœªä½¿ç”¨çš„èµ„æº</span>
docker system prune -a
</code></pre></div></li>
<li>
<p><strong>ç½‘ç»œé—®é¢˜</strong></p>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash"><span class="hljs-comment"># é‡å¯DockeræœåŠ¡</span>
<span class="hljs-built_in">sudo</span> systemctl restart docker
</code></pre></div></li>
</ol>
<h2>Dockerä¸Kubernetes</h2>
<p>è™½ç„¶Dockeræ˜¯å®¹å™¨åŒ–æŠ€æœ¯çš„åŸºç¡€ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨Kubernetesè¿›è¡Œå®¹å™¨ç¼–æ’ã€‚</p>
<h3>Kubernetesä¸­çš„Dockeré•œåƒ</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs"># deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
spec:
  replicas: 3
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      containers:
      - name: myapp
        image: myusername/myapp:latest
        ports:
        - containerPort: 3000
</code></pre></div><h2>æœªæ¥è¶‹åŠ¿</h2>
<h3>1. å®¹å™¨è¿è¡Œæ—¶çš„å¤šæ ·åŒ–</h3>
<p>é™¤äº†Dockerï¼Œè¿˜æœ‰å…¶ä»–å®¹å™¨è¿è¡Œæ—¶å¦‚containerdã€CRI-Oç­‰ã€‚</p>
<h3>2. æ— æœåŠ¡å™¨å®¹å™¨</h3>
<p>å¹³å°å¦‚AWS Fargateã€Google Cloud Runæä¾›äº†æ— æœåŠ¡å™¨çš„å®¹å™¨è¿è¡Œç¯å¢ƒã€‚</p>
<h3>3. è¾¹ç¼˜è®¡ç®—</h3>
<p>å®¹å™¨æŠ€æœ¯åœ¨è¾¹ç¼˜è®¡ç®—åœºæ™¯ä¸­çš„åº”ç”¨è¶Šæ¥è¶Šå¹¿æ³›ã€‚</p>
<h2>ç»“è¯­</h2>
<p>Dockerä½œä¸ºå®¹å™¨åŒ–æŠ€æœ¯çš„ä»£è¡¨ï¼Œå·²ç»æˆä¸ºäº†ç°ä»£è½¯ä»¶å¼€å‘å’Œéƒ¨ç½²çš„æ ‡å‡†å·¥å…·ã€‚é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œä½ åº”è¯¥å¯¹Dockerçš„æ ¸å¿ƒæ¦‚å¿µã€ä½¿ç”¨æ–¹æ³•å’Œæœ€ä½³å®è·µæœ‰äº†å…¨é¢çš„äº†è§£ã€‚</p>
<p>æŒæ¡Dockerä¸ä»…èƒ½å¤Ÿæé«˜å¼€å‘æ•ˆç‡ï¼Œè¿˜èƒ½ç¡®ä¿åº”ç”¨ç¨‹åºåœ¨ä¸åŒç¯å¢ƒä¸­çš„ä¸€è‡´æ€§ï¼Œæ˜¯æ¯ä¸ªå¼€å‘è€…éƒ½åº”è¯¥æŒæ¡çš„é‡è¦æŠ€èƒ½ã€‚éšç€å®¹å™¨æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œå­¦ä¹ Dockerå°†ä¸ºä½ çš„æŠ€æœ¯ç”Ÿæ¶¯å¸¦æ¥æ›´å¤šå¯èƒ½æ€§ã€‚</p>

            </div>
        </article>
    </main>
    <footer class="footer">
        <div class="max-w-6xl mx-auto px-4">
            <p>&copy; 2025 äººäººé“¾å‘æœªæ¥. All rights reserved.</p>
            <p class="mt-2"><a href="/rss.xml" class="text-accent-400 hover:text-accent-500">ğŸ“¡ è®¢é˜… RSS</a></p>
        </div>
    </footer>
    <script>
        // ç§»åŠ¨ç«¯å¯¼èˆªèœå•åˆ‡æ¢ + ä»£ç å¤åˆ¶æŒ‰é’®
        document.addEventListener('DOMContentLoaded', function() {
                // å›¾ç‰‡åŠ è½½å¤±è´¥å ä½ç¬¦
                document.querySelectorAll('img').forEach(img => {
                    img.addEventListener('error', function() {
                        if (this.dataset.fallbackApplied) return;
                        this.dataset.fallbackApplied = '1';
                        this.src = '/assets/placeholder.png';
                        this.classList.add('placeholder');
                    }, { once: true });
                });
            const navbarToggle = document.getElementById('navbar-toggle');
            const navbarMenu = document.getElementById('navbar-menu');
            
            if (navbarToggle && navbarMenu) {
                navbarToggle.addEventListener('click', function() {
                    navbarToggle.classList.toggle('open');
                    navbarMenu.classList.toggle('open');
                });
                
                // ç‚¹å‡»èœå•é¡¹åå…³é—­èœå•
                const navItems = navbarMenu.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    item.addEventListener('click', function() {
                        navbarToggle.classList.remove('open');
                        navbarMenu.classList.remove('open');
                    });
                });
                
                // ç‚¹å‡»èœå•å¤–éƒ¨å…³é—­èœå•
                document.addEventListener('click', function(e) {
                    if (!navbarToggle.contains(e.target) && !navbarMenu.contains(e.target)) {
                        navbarToggle.classList.remove('open');
                        navbarMenu.classList.remove('open');
                    }
                });
            }

            // å¤åˆ¶ä»£ç ï¼šäº‹ä»¶å§”æ‰˜
            document.body.addEventListener('click', async (e) => {
                const btn = e.target.closest('.copy-code-btn');
                if (!btn) return;
                const container = btn.closest('.code-block');
                if (!container) return;
                const codeEl = container.querySelector('pre code');
                if (!codeEl) return;
                const text = codeEl.innerText;
                try {
                    await navigator.clipboard.writeText(text);
                    const original = btn.textContent;
                    btn.textContent = 'å·²å¤åˆ¶';
                    btn.classList.add('copied');
                    setTimeout(() => {
                        btn.textContent = original;
                        btn.classList.remove('copied');
                    }, 1200);
                } catch (err) {
                    // å›é€€æ–¹æ¡ˆ
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    try { document.execCommand('copy'); } catch {}
                    document.body.removeChild(textarea);
                    const original = btn.textContent;
                    btn.textContent = 'å·²å¤åˆ¶';
                    btn.classList.add('copied');
                    setTimeout(() => {
                        btn.textContent = original;
                        btn.classList.remove('copied');
                    }, 1200);
                }
            });
        });
    </script>
</body>
</html>