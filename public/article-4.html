<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pythonæ•°æ®åˆ†æå…¥é—¨ï¼šä½¿ç”¨Pandaså¤„ç†CSVæ–‡ä»¶</title>
    <link rel="stylesheet" href="/styles/modern.css">
    <link rel="alternate" type="application/rss+xml" title="äººäººé“¾å‘æœªæ¥ RSS Feed" href="/rss.xml">
    <!-- Highlight.js theme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
                        colors: {
                            primary: { 600: '#FECE00', 700: '#e6b900' },
                            accent: { 400: '#FECE00', 500: '#ffdb4d' }
                        }
          }
        }
      }
    </script>
</head>
<body class="bg-gray-50">
    <header class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="/" class="navbar-logo">äººäººé“¾å‘æœªæ¥</a>
            </div>
            <nav class="navbar-menu" id="navbar-menu">
                <div class="navbar-nav">
                    <a href="/" class="nav-item">
                        <span class="nav-text">é¦–é¡µ</span>
                    </a>
                    <a href="/about.html" class="nav-item">
                        <span class="nav-text">å…³äº</span>
                    </a>
                    <a href="/rss.xml" class="nav-item nav-item-special" target="_blank" rel="noopener noreferrer">
                        <span class="nav-text">RSS</span>
                    </a>
                </div>
            </nav>
            <button class="navbar-toggle" id="navbar-toggle" aria-label="åˆ‡æ¢å¯¼èˆªèœå•">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <article class="article-container">
            <div class="article-header">
                <h1 class="article-title">Pythonæ•°æ®åˆ†æå…¥é—¨ï¼šä½¿ç”¨Pandaså¤„ç†CSVæ–‡ä»¶</h1>
                <div class="article-meta">
                    <div class="flex items-center space-x-2">
                        <time datetime="2023-04-05T00:00:00.000Z">2023å¹´4æœˆ5æ—¥</time>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <span class="post-tag">python</span>
                        <span class="post-tag">data-science</span>
                        <span class="post-tag">pandas</span>
                    </div>
                </div>
            </div>
            <div class="article-content">
                <p>åœ¨æ•°æ®ç§‘å­¦é¢†åŸŸï¼ŒPythonçš„Pandasåº“æ˜¯ä¸€ä¸ªä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Pandasæ¥å¤„ç†CSVæ–‡ä»¶ï¼Œè¿™æ˜¯æ•°æ®åˆ†æä¸­æœ€å¸¸è§çš„ä»»åŠ¡ä¹‹ä¸€ã€‚</p>
<h2>ä»€ä¹ˆæ˜¯Pandasï¼Ÿ</h2>
<p>Pandasæ˜¯ä¸€ä¸ªå¼€æºçš„æ•°æ®æ“ä½œå’Œåˆ†æåº“ï¼Œæä¾›äº†é«˜æ€§èƒ½ã€æ˜“ç”¨çš„æ•°æ®ç»“æ„å’Œæ•°æ®åˆ†æå·¥å…·ã€‚</p>
<h2>å®‰è£…Pandas</h2>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-bash">pip install pandas
</code></pre></div><h2>åŸºæœ¬æ“ä½œ</h2>
<h3>è¯»å–CSVæ–‡ä»¶</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># è¯»å–CSVæ–‡ä»¶</span>
df = pd.read_csv(<span class="hljs-string">&#x27;data.csv&#x27;</span>)

<span class="hljs-comment"># æŸ¥çœ‹å‰5è¡Œæ•°æ®</span>
<span class="hljs-built_in">print</span>(df.head())

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®çš„åŸºæœ¬ä¿¡æ¯</span>
<span class="hljs-built_in">print</span>(df.info())

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®çš„ç»Ÿè®¡æ‘˜è¦</span>
<span class="hljs-built_in">print</span>(df.describe())
</code></pre></div><h3>æ•°æ®æ¢ç´¢</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-comment"># æŸ¥çœ‹åˆ—å</span>
<span class="hljs-built_in">print</span>(df.columns)

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®å½¢çŠ¶</span>
<span class="hljs-built_in">print</span>(df.shape)

<span class="hljs-comment"># æ£€æŸ¥ç¼ºå¤±å€¼</span>
<span class="hljs-built_in">print</span>(df.isnull().<span class="hljs-built_in">sum</span>())

<span class="hljs-comment"># æŸ¥çœ‹å”¯ä¸€å€¼</span>
<span class="hljs-built_in">print</span>(df[<span class="hljs-string">&#x27;column_name&#x27;</span>].unique())
</code></pre></div><h3>æ•°æ®æ¸…æ´—</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-comment"># åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ</span>
df_cleaned = df.dropna()

<span class="hljs-comment"># å¡«å……ç¼ºå¤±å€¼</span>
df[<span class="hljs-string">&#x27;column_name&#x27;</span>].fillna(<span class="hljs-number">0</span>, inplace=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># åˆ é™¤é‡å¤è¡Œ</span>
df.drop_duplicates(inplace=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># æ•°æ®ç±»å‹è½¬æ¢</span>
df[<span class="hljs-string">&#x27;column_name&#x27;</span>] = df[<span class="hljs-string">&#x27;column_name&#x27;</span>].astype(<span class="hljs-string">&#x27;int&#x27;</span>)
</code></pre></div><h3>æ•°æ®ç­›é€‰å’Œæ’åº</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-comment"># ç­›é€‰æ•°æ®</span>
filtered_df = df[df[<span class="hljs-string">&#x27;column_name&#x27;</span>] &gt; <span class="hljs-number">100</span>]

<span class="hljs-comment"># å¤šæ¡ä»¶ç­›é€‰</span>
filtered_df = df[(df[<span class="hljs-string">&#x27;column1&#x27;</span>] &gt; <span class="hljs-number">50</span>) &amp; (df[<span class="hljs-string">&#x27;column2&#x27;</span>] == <span class="hljs-string">&#x27;value&#x27;</span>)]

<span class="hljs-comment"># æ’åº</span>
sorted_df = df.sort_values(<span class="hljs-string">&#x27;column_name&#x27;</span>, ascending=<span class="hljs-literal">False</span>)

<span class="hljs-comment"># æŒ‰å¤šåˆ—æ’åº</span>
sorted_df = df.sort_values([<span class="hljs-string">&#x27;column1&#x27;</span>, <span class="hljs-string">&#x27;column2&#x27;</span>])
</code></pre></div><h3>æ•°æ®åˆ†ç»„å’Œèšåˆ</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-comment"># æŒ‰åˆ—åˆ†ç»„</span>
grouped = df.groupby(<span class="hljs-string">&#x27;category_column&#x27;</span>)

<span class="hljs-comment"># è®¡ç®—æ¯ç»„çš„å¹³å‡å€¼</span>
mean_values = grouped[<span class="hljs-string">&#x27;numeric_column&#x27;</span>].mean()

<span class="hljs-comment"># å¤šç§èšåˆæ“ä½œ</span>
agg_result = grouped.agg({
    <span class="hljs-string">&#x27;column1&#x27;</span>: <span class="hljs-string">&#x27;mean&#x27;</span>,
    <span class="hljs-string">&#x27;column2&#x27;</span>: <span class="hljs-string">&#x27;sum&#x27;</span>,
    <span class="hljs-string">&#x27;column3&#x27;</span>: <span class="hljs-string">&#x27;count&#x27;</span>
})
</code></pre></div><h3>æ•°æ®å¯è§†åŒ–</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># ç»˜åˆ¶ç›´æ–¹å›¾</span>
df[<span class="hljs-string">&#x27;column_name&#x27;</span>].hist()
plt.show()

<span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
df.plot(x=<span class="hljs-string">&#x27;column1&#x27;</span>, y=<span class="hljs-string">&#x27;column2&#x27;</span>, kind=<span class="hljs-string">&#x27;scatter&#x27;</span>)
plt.show()

<span class="hljs-comment"># ç»˜åˆ¶æ¡å½¢å›¾</span>
df[<span class="hljs-string">&#x27;category_column&#x27;</span>].value_counts().plot(kind=<span class="hljs-string">&#x27;bar&#x27;</span>)
plt.show()
</code></pre></div><h2>å®é™…æ¡ˆä¾‹ï¼šé”€å”®æ•°æ®åˆ†æ</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé”€å”®æ•°æ®CSVæ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼šæ—¥æœŸã€äº§å“ã€é”€å”®é‡ã€ä»·æ ¼ã€‚</p>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># è¯»å–æ•°æ®</span>
sales_df = pd.read_csv(<span class="hljs-string">&#x27;sales_data.csv&#x27;</span>)

<span class="hljs-comment"># æ•°æ®æ¦‚è§ˆ</span>
<span class="hljs-built_in">print</span>(sales_df.head())
<span class="hljs-built_in">print</span>(sales_df.info())

<span class="hljs-comment"># è®¡ç®—æ€»é”€å”®é¢</span>
sales_df[<span class="hljs-string">&#x27;total_sales&#x27;</span>] = sales_df[<span class="hljs-string">&#x27;quantity&#x27;</span>] * sales_df[<span class="hljs-string">&#x27;price&#x27;</span>]

<span class="hljs-comment"># æŒ‰äº§å“åˆ†ç»„è®¡ç®—æ€»é”€å”®é¢</span>
product_sales = sales_df.groupby(<span class="hljs-string">&#x27;product&#x27;</span>)[<span class="hljs-string">&#x27;total_sales&#x27;</span>].<span class="hljs-built_in">sum</span>().sort_values(ascending=<span class="hljs-literal">False</span>)
<span class="hljs-built_in">print</span>(product_sales)

<span class="hljs-comment"># æŒ‰æœˆä»½åˆ†æé”€å”®è¶‹åŠ¿</span>
sales_df[<span class="hljs-string">&#x27;date&#x27;</span>] = pd.to_datetime(sales_df[<span class="hljs-string">&#x27;date&#x27;</span>])
sales_df[<span class="hljs-string">&#x27;month&#x27;</span>] = sales_df[<span class="hljs-string">&#x27;date&#x27;</span>].dt.to_period(<span class="hljs-string">&#x27;M&#x27;</span>)
monthly_sales = sales_df.groupby(<span class="hljs-string">&#x27;month&#x27;</span>)[<span class="hljs-string">&#x27;total_sales&#x27;</span>].<span class="hljs-built_in">sum</span>()
<span class="hljs-built_in">print</span>(monthly_sales)

<span class="hljs-comment"># å¯è§†åŒ–æœˆåº¦é”€å”®è¶‹åŠ¿</span>
monthly_sales.plot(kind=<span class="hljs-string">&#x27;line&#x27;</span>, marker=<span class="hljs-string">&#x27;o&#x27;</span>)
plt.title(<span class="hljs-string">&#x27;Monthly Sales Trend&#x27;</span>)
plt.xlabel(<span class="hljs-string">&#x27;Month&#x27;</span>)
plt.ylabel(<span class="hljs-string">&#x27;Total Sales&#x27;</span>)
plt.show()
</code></pre></div><h2>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2>
<h3>1. è¯»å–å¤§å‹CSVæ–‡ä»¶</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-comment"># åªè¯»å–éœ€è¦çš„åˆ—</span>
df = pd.read_csv(<span class="hljs-string">&#x27;large_file.csv&#x27;</span>, usecols=[<span class="hljs-string">&#x27;col1&#x27;</span>, <span class="hljs-string">&#x27;col2&#x27;</span>, <span class="hljs-string">&#x27;col3&#x27;</span>])

<span class="hljs-comment"># åˆ†å—è¯»å–</span>
chunk_list = []
<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> pd.read_csv(<span class="hljs-string">&#x27;large_file.csv&#x27;</span>, chunksize=<span class="hljs-number">1000</span>):
    <span class="hljs-comment"># å¤„ç†æ¯ä¸ªå—</span>
    processed_chunk = chunk.groupby(<span class="hljs-string">&#x27;column&#x27;</span>).<span class="hljs-built_in">sum</span>()
    chunk_list.append(processed_chunk)
    
final_df = pd.concat(chunk_list)
</code></pre></div><h3>2. ä½¿ç”¨é€‚å½“çš„æ•°æ®ç±»å‹</h3>
<div class="code-block"><button class="copy-code-btn" type="button" aria-label="å¤åˆ¶ä»£ç ">å¤åˆ¶</button><pre><code class="hljs language-python"><span class="hljs-comment"># ä¼˜åŒ–æ•°æ®ç±»å‹ä»¥èŠ‚çœå†…å­˜</span>
df[<span class="hljs-string">&#x27;category_column&#x27;</span>] = df[<span class="hljs-string">&#x27;category_column&#x27;</span>].astype(<span class="hljs-string">&#x27;category&#x27;</span>)
df[<span class="hljs-string">&#x27;integer_column&#x27;</span>] = df[<span class="hljs-string">&#x27;integer_column&#x27;</span>].astype(<span class="hljs-string">&#x27;int32&#x27;</span>)
</code></pre></div><h2>ç»“è¯­</h2>
<p>Pandasæ˜¯Pythonæ•°æ®åˆ†æçš„å¼ºå¤§å·¥å…·ï¼ŒæŒæ¡å…¶åŸºæœ¬æ“ä½œå¯¹äºæ•°æ®ç§‘å­¦å®¶å’Œåˆ†æå¸ˆæ¥è¯´è‡³å…³é‡è¦ã€‚é€šè¿‡å®è·µè¿™äº›æŠ€å·§ï¼Œæ‚¨å¯ä»¥æ›´é«˜æ•ˆåœ°å¤„ç†å’Œåˆ†ææ•°æ®ï¼Œä¸ºå†³ç­–æä¾›æœ‰åŠ›æ”¯æŒã€‚</p>

            </div>
        </article>
    </main>
    <footer class="footer">
        <div class="max-w-6xl mx-auto px-4">
            <p>&copy; 2025 äººäººé“¾å‘æœªæ¥. All rights reserved.</p>
            <p class="mt-2"><a href="/rss.xml" class="text-accent-400 hover:text-accent-500">ğŸ“¡ è®¢é˜… RSS</a></p>
        </div>
    </footer>
    <script>
        // ç§»åŠ¨ç«¯å¯¼èˆªèœå•åˆ‡æ¢ + ä»£ç å¤åˆ¶æŒ‰é’®
        document.addEventListener('DOMContentLoaded', function() {
                // å›¾ç‰‡åŠ è½½å¤±è´¥å ä½ç¬¦
                document.querySelectorAll('img').forEach(img => {
                    img.addEventListener('error', function() {
                        if (this.dataset.fallbackApplied) return;
                        this.dataset.fallbackApplied = '1';
                        this.src = '/assets/placeholder.png';
                        this.classList.add('placeholder');
                    }, { once: true });
                });
            const navbarToggle = document.getElementById('navbar-toggle');
            const navbarMenu = document.getElementById('navbar-menu');
            
            if (navbarToggle && navbarMenu) {
                navbarToggle.addEventListener('click', function() {
                    navbarToggle.classList.toggle('open');
                    navbarMenu.classList.toggle('open');
                });
                
                // ç‚¹å‡»èœå•é¡¹åå…³é—­èœå•
                const navItems = navbarMenu.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    item.addEventListener('click', function() {
                        navbarToggle.classList.remove('open');
                        navbarMenu.classList.remove('open');
                    });
                });
                
                // ç‚¹å‡»èœå•å¤–éƒ¨å…³é—­èœå•
                document.addEventListener('click', function(e) {
                    if (!navbarToggle.contains(e.target) && !navbarMenu.contains(e.target)) {
                        navbarToggle.classList.remove('open');
                        navbarMenu.classList.remove('open');
                    }
                });
            }

            // å¤åˆ¶ä»£ç ï¼šäº‹ä»¶å§”æ‰˜
            document.body.addEventListener('click', async (e) => {
                const btn = e.target.closest('.copy-code-btn');
                if (!btn) return;
                const container = btn.closest('.code-block');
                if (!container) return;
                const codeEl = container.querySelector('pre code');
                if (!codeEl) return;
                const text = codeEl.innerText;
                try {
                    await navigator.clipboard.writeText(text);
                    const original = btn.textContent;
                    btn.textContent = 'å·²å¤åˆ¶';
                    btn.classList.add('copied');
                    setTimeout(() => {
                        btn.textContent = original;
                        btn.classList.remove('copied');
                    }, 1200);
                } catch (err) {
                    // å›é€€æ–¹æ¡ˆ
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    try { document.execCommand('copy'); } catch {}
                    document.body.removeChild(textarea);
                    const original = btn.textContent;
                    btn.textContent = 'å·²å¤åˆ¶';
                    btn.classList.add('copied');
                    setTimeout(() => {
                        btn.textContent = original;
                        btn.classList.remove('copied');
                    }, 1200);
                }
            });
        });
    </script>
</body>
</html>